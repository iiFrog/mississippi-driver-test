<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mississippi Driver's Permit Test (2025)</title>
    <style>
        /* CSS Variables for Theme Support */
        :root {
            --background-color: #f5f5f5;
            --text-color: #333;
            --container-bg: white;
            --question-bg: #f9f9f9;
            --question-border: #3498db;
            --option-bg: #f0f0f0;
            --option-hover: #e0e0e0;
            --button-bg: #3498db;
            --button-hover: #2980b9;
            --results-bg: #f0f8ff;
            --heading-color: #2c3e50;
            --correct-color: #27ae60;
            --incorrect-color: #e74c3c;
            --study-guide-btn: #2ecc71;
            --study-guide-hover: #27ae60;
            --reset-btn: #7f8c8d;
            --reset-hover: #95a5a6;
            --box-shadow: rgba(0, 0, 0, 0.1);
            --selector-bg: #ecf0f1;
            --selector-border: #bdc3c7;
        }

        /* Dark Mode Variables */
        body.dark-mode {
            --background-color: #121212;
            --text-color: #e0e0e0;
            --container-bg: #1e1e1e;
            --question-bg: #2a2a2a;
            --question-border: #3498db;
            --option-bg: #333333;
            --option-hover: #444444;
            --button-bg: #2980b9;
            --button-hover: #3498db;
            --results-bg: #1a2733;
            --heading-color: #82b1ff;
            --correct-color: #00e676;
            --incorrect-color: #ff5252;
            --study-guide-btn: #2ecc71;
            --study-guide-hover: #27ae60;
            --reset-btn: #607d8b;
            --reset-hover: #78909c;
            --box-shadow: rgba(0, 0, 0, 0.3);
            --selector-bg: #2c3e50;
            --selector-border: #34495e;
        }

        /* Global Styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--background-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }

        h1 {
            text-align: center;
            color: var(--heading-color);
            margin-bottom: 30px;
        }

        .quiz-container {
            background-color: var(--container-bg);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 8px var(--box-shadow);
            transition: background-color 0.3s, box-shadow 0.3s;
            position: relative;
        }

        .question {
            background-color: var(--question-bg);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            border-left: 4px solid var(--question-border);
            transition: background-color 0.3s;
        }

        .options {
            margin-left: 20px;
        }

        label {
            display: block;
            margin: 8px 0;
            padding: 10px;
            background-color: var(--option-bg);
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        label:hover {
            background-color: var(--option-hover);
        }

        input[type="radio"] {
            margin-right: 10px;
            cursor: pointer;
        }

        button {
            background-color: var(--button-bg);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: var(--button-hover);
        }

        .button-group {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .button-group button {
            margin: 0;
        }

        .question-count-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .question-count-btn {
            padding: 8px 16px;
            background-color: var(--option-bg);
            border: 1px solid var(--selector-border);
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .question-count-btn.active {
            background-color: var(--button-bg);
            color: white;
        }

        .question-count-btn:hover {
            background-color: var(--option-hover);
        }

        .question-count-btn.active:hover {
            background-color: var(--button-hover);
        }

        .results {
            display: none;
            background-color: var(--results-bg);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            transition: background-color 0.3s;
        }

        .results h2 {
            color: var(--heading-color);
            margin-bottom: 15px;
        }

        .result-count {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .review-container {
            margin-top: 20px;
            text-align: left;
        }

        .review-question {
            background-color: var(--question-bg);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .correct {
            border-left: 4px solid var(--correct-color);
        }

        .incorrect {
            border-left: 4px solid var(--incorrect-color);
        }

        .correct-answer {
            color: var(--correct-color);
            font-weight: bold;
        }

        .wrong-answer {
            color: var(--incorrect-color);
            text-decoration: line-through;
        }

        .reset-btn {
            background-color: var(--reset-btn);
        }

        .reset-btn:hover {
            background-color: var(--reset-hover);
        }

        .study-guide-btn {
            background-color: var(--study-guide-btn);
        }

        .study-guide-btn:hover {
            background-color: var(--study-guide-hover);
        }

        .study-guide {
            display: none;
            background-color: var(--question-bg);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            transition: background-color 0.3s;
        }

        .study-guide h2 {
            color: var(--heading-color);
            margin-bottom: 15px;
        }
        
        .study-section {
            margin-bottom: 20px;
        }
        
        .study-section h3 {
            color: var(--question-border);
            border-bottom: 1px solid var(--option-bg);
            padding-bottom: 5px;
        }

        .manual-container {
            display: none;
            margin-top: 20px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px var(--box-shadow);
        }

        .manual-container iframe {
            width: 100%;
            height: 600px;
            border: none;
        }

        /* Theme Toggle Button */
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px 12px;
            background-color: var(--option-bg);
            border-radius: 30px;
            transition: background-color 0.3s;
            z-index: 10;
        }

        .theme-toggle:hover {
            background-color: var(--option-hover);
        }

        .theme-toggle-track {
            width: 40px;
            height: 20px;
            background-color: #aaa;
            border-radius: 10px;
            position: relative;
            margin-left: 8px;
            transition: background-color 0.3s;
        }

        .theme-toggle-thumb {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: white;
            transition: transform 0.3s, background-color 0.3s;
        }

        .dark-mode .theme-toggle-track {
            background-color: #3498db;
        }

        .dark-mode .theme-toggle-thumb {
            transform: translateX(20px);
            background-color: #1e1e1e;
        }

        .tab-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-button {
            background-color: var(--option-bg);
            color: var(--text-color);
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
        }

        .tab-button.active {
            background-color: var(--button-bg);
            color: white;
        }

        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            
            .quiz-container {
                padding: 15px;
            }
            
            label {
                padding: 8px;
            }

            .theme-toggle {
                top: 10px;
                right: 10px;
                padding: 6px 10px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .question-count-selector {
                flex-wrap: wrap;
            }
            
            .manual-container iframe {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <h1>Mississippi Driver's Permit Test (2025)</h1>
    
    <div class="quiz-container">
        <div class="theme-toggle" id="theme-toggle">
            <span>Dark Mode</span>
            <div class="theme-toggle-track">
                <div class="theme-toggle-thumb"></div>
            </div>
        </div>

        <div class="tab-buttons">
            <button id="test-tab" class="tab-button active">Practice Test</button>
            <button id="study-tab" class="tab-button">Study Guide</button>
            <button id="manual-tab" class="tab-button">Driver's Manual</button>
        </div>

        <div id="test-section">
            <div class="question-count-selector">
                <button class="question-count-btn" data-count="10">10 Questions</button>
                <button class="question-count-btn" data-count="20">20 Questions</button>
                <button class="question-count-btn active" data-count="30">30 Questions</button>
                <button class="question-count-btn" data-count="50">50 Questions</button>
            </div>
            
            <form id="quiz-form">
                <!-- Questions will be inserted here by JavaScript -->
            </form>
            
            <div class="button-group">
                <button id="submit-btn" type="button">Submit Test</button>
                <button id="shuffle-btn" type="button">Shuffle Questions</button>
            </div>
            
            <div id="results" class="results">
                <h2>Test Results</h2>
                <div id="score" class="result-count"></div>
                <div id="review" class="review-container"></div>
                <div class="button-group">
                    <button id="reset-btn" class="reset-btn" type="button">Retake Test</button>
                    <button id="view-study-guide-btn" class="study-guide-btn" type="button">View Study Guide</button>
                </div>
            </div>
        </div>

        <div id="study-guide" class="study-guide">
            <!-- Study guide content will be inserted here by JavaScript -->
        </div>

        <div id="manual-container" class="manual-container">
            <iframe id="manual-iframe" src="1.15.2025 Revised MDPS Driver's Manual.pdf" frameborder="0"></iframe>
        </div>
    </div>

    <script>
        // Test questions data - Updated with accurate information from the 2025 manual
        const questions = [
            {
                question: "What is the minimum age to apply for a Regular Learner's Permit in Mississippi?",
                options: [
                    "14 years old",
                    "15 years old",
                    "16 years old",
                    "17 years old"
                ],
                answer: "B"
            },
            {
                question: "Which document is NOT required when applying for a driver's license in Mississippi?",
                options: [
                    "Social Security card",
                    "Certified birth certificate",
                    "Proof of residency",
                    "High school diploma"
                ],
                answer: "D"
            },
            {
                question: "When driving with a Regular Learner's Permit, you must be accompanied by:",
                options: [
                    "A licensed driver aged 18 or older",
                    "A licensed driver aged 21 or older",
                    "A parent or legal guardian",
                    "Any licensed driver"
                ],
                answer: "B"
            },
            {
                question: "What does a red octagonal sign indicate?",
                options: [
                    "Yield",
                    "Stop",
                    "No entry",
                    "Railroad crossing"
                ],
                answer: "B"
            },
            {
                question: "What does a yellow diamond-shaped sign warn of?",
                options: [
                    "A stop sign ahead",
                    "A yield sign ahead",
                    "A hazard or special condition ahead",
                    "A railroad crossing ahead"
                ],
                answer: "C"
            },
            {
                question: "What does a broken yellow line on the road indicate?",
                options: [
                    "Passing is allowed with caution",
                    "Passing is prohibited",
                    "The lane is for left turns only",
                    "The road is about to end"
                ],
                answer: "A"
            },
            {
                question: "What does a solid white line on the road mean?",
                options: [
                    "Traffic is moving in opposite directions",
                    "Passing is allowed",
                    "Lane changing is discouraged",
                    "The road is one-way"
                ],
                answer: "C"
            },
            {
                question: "What is the speed limit in a school zone when children are present, unless otherwise posted?",
                options: [
                    "15 mph",
                    "20 mph",
                    "25 mph",
                    "30 mph"
                ],
                answer: "A"
            },
            {
                question: "When must you use your headlights?",
                options: [
                    "Only at night",
                    "When visibility is less than 500 feet",
                    "When driving in rain or fog",
                    "All of the above"
                ],
                answer: "D"
            },
            {
                question: "In Mississippi, seat belts are required for:",
                options: [
                    "The driver only",
                    "The driver and front-seat passengers",
                    "All passengers",
                    "Only passengers under 18"
                ],
                answer: "B"
            },
            {
                question: "What is the penalty for a first-offense DUI for a driver 21 or older in Mississippi?",
                options: [
                    "$100 fine and 24 hours in jail",
                    "$250-$1,000 fine and up to 48 hours in jail",
                    "$500 fine and 5 days in jail",
                    "$1,000 fine and 1 year license suspension"
                ],
                answer: "B"
            },
            {
                question: "What should you do if you witness an accident?",
                options: [
                    "Keep driving to avoid traffic congestion",
                    "Stop and offer assistance if it's safe",
                    "Call 911 and then leave",
                    "Take pictures for insurance purposes"
                ],
                answer: "B"
            },
            {
                question: "When passing a bicycle, you must leave a safe distance of at least:",
                options: [
                    "1 foot",
                    "2 feet",
                    "3 feet",
                    "4 feet"
                ],
                answer: "C"
            },
            {
                question: "How should you merge onto an interstate highway?",
                options: [
                    "Stop at the end of the ramp and wait for a gap",
                    "Speed up to match traffic speed and merge smoothly",
                    "Use your hazard lights to alert other drivers",
                    "Honk your horn to signal your intention"
                ],
                answer: "B"
            },
            {
                question: "What does a green arrow traffic signal indicate?",
                options: [
                    "You may proceed in the direction of the arrow",
                    "You must stop and then proceed",
                    "Pedestrians may cross",
                    "The light is about to change"
                ],
                answer: "A"
            },
            {
                question: "When an emergency vehicle with lights and siren approaches, you should:",
                options: [
                    "Speed up to get out of the way",
                    "Pull over to the right and stop",
                    "Continue driving and let them pass",
                    "Honk to acknowledge their presence"
                ],
                answer: "B"
            },
            {
                question: "When driving through a roundabout, you should:",
                options: [
                    "Yield to traffic already in the roundabout",
                    "Stop before entering",
                    "Speed up to merge quickly",
                    "Honk to alert other drivers"
                ],
                answer: "A"
            },
            {
                question: "What should you do if your vehicle starts to skid?",
                options: [
                    "Slam on the brakes",
                    "Steer in the direction you want to go",
                    "Accelerate quickly",
                    "Turn the steering wheel sharply"
                ],
                answer: "B"
            },
            {
                question: "What does a flashing yellow light mean?",
                options: [
                    "Stop and wait",
                    "Proceed with caution",
                    "Yield to oncoming traffic",
                    "No turn allowed"
                ],
                answer: "B"
            },
            {
                question: "What is the rule for turning right on red?",
                options: [
                    "It's never allowed",
                    "Stop first, then turn if safe",
                    "Turn without stopping",
                    "Yield to pedestrians only"
                ],
                answer: "B"
            },
            {
                question: "How should you park on a hill if facing downhill?",
                options: [
                    "Wheels straight",
                    "Wheels turned away from the curb",
                    "Wheels turned toward the curb",
                    "Wheels turned to the left"
                ],
                answer: "C"
            },
            {
                question: "What should you do if your vehicle begins to hydroplane?",
                options: [
                    "Accelerate to regain control",
                    "Brake hard to stop",
                    "Ease off the accelerator and steer straight",
                    "Turn the wheel sharply"
                ],
                answer: "C"
            },
            {
                question: "What must you do at a railroad crossing with no signals if driving a truck with flammable loads?",
                options: [
                    "Proceed with caution",
                    "Stop and check for trains",
                    "Speed up to clear the tracks",
                    "Honk to warn others"
                ],
                answer: "B"
            },
            {
                question: "What does a pentagon-shaped sign indicate?",
                options: [
                    "No passing zone",
                    "School zone or crossing",
                    "Railroad crossing",
                    "Yield ahead"
                ],
                answer: "B"
            },
            {
                question: "When sharing the road with large trucks, you should avoid:",
                options: [
                    "Passing on the right during a right turn",
                    "Staying in their blind spots",
                    "Following too closely",
                    "All of the above"
                ],
                answer: "D"
            },
            {
                question: "What should you do if your accelerator sticks?",
                options: [
                    "Turn off the ignition while driving",
                    "Shift to neutral and apply brakes",
                    "Accelerate to free it",
                    "Pull over without braking"
                ],
                answer: "B"
            },
            {
                question: "What does a blue sign with white lettering typically indicate?",
                options: [
                    "Regulatory information",
                    "Motorist services guidance",
                    "Warning of a hazard",
                    "Construction zone"
                ],
                answer: "B"
            },
            {
                question: "What is the maximum speed limit on the Natchez Trace Parkway unless otherwise posted?",
                options: [
                    "45 mph",
                    "50 mph",
                    "55 mph",
                    "60 mph"
                ],
                answer: "B"
            },
            {
                question: "What is the minimum liability insurance required for property damage in Mississippi?",
                options: [
                    "$15,000",
                    "$20,000",
                    "$25,000",
                    "$50,000"
                ],
                answer: "C"
            },
            {
                question: "What must you do if you refuse a breath test under the Implied Consent Law?",
                options: [
                    "Pay a $100 fine immediately",
                    "Surrender your license for 90 days",
                    "Take a written test instead",
                    "Nothing, it's your right to refuse"
                ],
                answer: "B"
            },
            {
                question: "Beginning July 1, 2027, what will be required to obtain a driver's license in Mississippi?",
                options: [
                    "A high school diploma",
                    "Proof of insurance",
                    "Completion of a certified Driver's Education course",
                    "A doctor's medical clearance"
                ],
                answer: "C"
            },
            {
                question: "What is the minimum age to apply for a Regular Driver's License in Mississippi without having held a Learner's Permit for one year?",
                options: [
                    "16 years old",
                    "17 years old",
                    "18 years old",
                    "21 years old"
                ],
                answer: "B"
            },
            {
                question: "What is considered a 'squatted vehicle' under Mississippi law?",
                options: [
                    "A vehicle with tinted windows",
                    "A vehicle with the front fender raised 4 or more inches higher than the rear fender",
                    "A vehicle with oversized tires",
                    "A vehicle without proper mufflers"
                ],
                answer: "B"
            },
            {
                question: "What is the recommended following distance at 70 mph according to the Mississippi Driver's Manual?",
                options: [
                    "3 car lengths",
                    "5 car lengths",
                    "7 car lengths",
                    "10 car lengths"
                ],
                answer: "C"
            },
            {
                question: "Which of the following is NOT one of the required documents when applying for a driver's license in Mississippi?",
                options: [
                    "Social security card",
                    "Certified birth certificate",
                    "Two proofs of residency",
                    "High school transcript"
                ],
                answer: "D"
            },
            {
                question: "What does a triangular sign indicate?",
                options: [
                    "Stop",
                    "Yield",
                    "School zone",
                    "Construction area"
                ],
                answer: "B"
            },
            {
                question: "What arm signal indicates a right turn?",
                options: [
                    "Left arm straight out",
                    "Left arm pointed down",
                    "Left arm pointed up",
                    "Right arm straight out"
                ],
                answer: "C"
            },
            {
                question: "What is the BAC (Blood Alcohol Concentration) limit for drivers under 21 in Mississippi?",
                options: [
                    "0.00%",
                    "0.02%",
                    "0.05%",
                    "0.08%"
                ],
                answer: "B"
            },
            {
                question: "At a four-way stop, if two vehicles arrive at the same time, who has the right of way?",
                options: [
                    "The vehicle on the right",
                    "The vehicle on the left",
                    "The larger vehicle",
                    "The vehicle going straight"
                ],
                answer: "A"
            },
            {
                question: "How close to the curb should you park when parallel parking?",
                options: [
                    "Within 6 inches",
                    "Within 12 inches",
                    "Within 18 inches",
                    "Within 24 inches"
                ],
                answer: "B"
            },
            {
                question: "What distance must your horn be audible from?",
                options: [
                    "100 feet",
                    "200 feet",
                    "300 feet",
                    "500 feet"
                ],
                answer: "B"
            },
            {
                question: "What should you do if your brakes fail?",
                options: [
                    "Pump the brake pedal rapidly",
                    "Use the parking brake gradually",
                    "Shift to a lower gear to slow down",
                    "All of the above"
                ],
                answer: "D"
            },
            {
                question: "When is it legal to exceed the posted speed limit in Mississippi?",
                options: [
                    "When passing another vehicle",
                    "When late for an appointment",
                    "When driving on an interstate highway",
                    "It is never legal to exceed the posted speed limit"
                ],
                answer: "D"
            },
            {
                question: "What does a solid yellow line on your side of the center line mean?",
                options: [
                    "Passing is permitted",
                    "Passing is prohibited",
                    "You are in a no-parking zone",
                    "You are approaching a school zone"
                ],
                answer: "B"
            },
            {
                question: "What is the minimum bodily injury liability coverage required per person in Mississippi?",
                options: [
                    "$15,000",
                    "$25,000",
                    "$50,000",
                    "$100,000"
                ],
                answer: "B"
            },
            {
                question: "What is the minimum age to apply for a Class D license in Mississippi?",
                options: [
                    "16 years old",
                    "17 years old",
                    "18 years old",
                    "21 years old"
                ],
                answer: "C"
            },
            {
                question: "What should you do when approaching a school bus with flashing red lights?",
                options: [
                    "Pass slowly and carefully",
                    "Stop and remain stopped until the red lights are turned off",
                    "Honk to alert the driver you are passing",
                    "Slow down to 15 mph and pass"
                ],
                answer: "B"
            },
            {
                question: "How far must your headlights be visible from?",
                options: [
                    "200 feet",
                    "300 feet",
                    "400 feet",
                    "500 feet"
                ],
                answer: "D"
            },
            {
                question: "What does an orange color on traffic signs indicate?",
                options: [
                    "Regulatory information",
                    "Construction or maintenance warning",
                    "Motorist services",
                    "School zone"
                ],
                answer: "B"
            }
        ];

        // Study guide content
        const studyGuide = [
            {
                title: "License Requirements",
                content: `
                    <p><strong>Minimum Age:</strong> 15 for a Regular Learner's Permit; 17 without needing 1 year permit experience.</p>
                    <p><strong>Documents:</strong> Social Security card, certified birth certificate, two proofs of residency.</p>
                    <p><strong>Learner's Permit Rules:</strong> Must be with a licensed driver 21+.</p>
                    <p><strong>New Requirement:</strong> Beginning July 1, 2027, completion of a certified Driver's Education course.</p>
                `
            },
            {
                title: "Traffic Signs and Signals",
                content: `
                    <p><strong>Shapes:</strong> Octagon = Stop; Diamond = Hazard; Pentagon = School; Triangle = Yield.</p>
                    <p><strong>Colors:</strong> Red = Stop; Yellow = Warning; Blue = Services; Orange = Construction.</p>
                    <p><strong>Signal Lights:</strong> Red = Stop; Yellow = Caution; Green = Go; Flashing Red = Stop and proceed when safe; Flashing Yellow = Proceed with caution.</p>
                `
            },
            {
                title: "Pavement Markings",
                content: `
                    <p><strong>Yellow Lines:</strong> Broken = Pass with caution; Solid = No passing.</p>
                    <p><strong>White Lines:</strong> Solid = Lane change discouraged; Double solid = No crossing.</p>
                    <p><strong>Directional Arrows:</strong> Indicate required or permitted movements at intersections.</p>
                `
            },
            {
                title: "Rules of the Road",
                content: `
                    <p><strong>Speed Limits:</strong> School zones = 15 mph; Interstates = 70 mph.</p>
                    <p><strong>Following Distance:</strong> At least 7 car lengths at 70 mph.</p>
                    <p><strong>Right of Way:</strong> Yield to vehicle on right at intersections if arriving simultaneously.</p>
                    <p><strong>School Buses:</strong> Stop when red lights are flashing.</p>
                    <p><strong>Sharing the Road:</strong> Leave at least 3 feet when passing bicycles.</p>
                `
            },
            {
                title: "Vehicle Requirements",
                content: `
                    <p><strong>Equipment:</strong> Functioning headlights, taillights, brakes, horn, and windshield wipers.</p>
                    <p><strong>Insurance:</strong> Minimum coverage of $25,000/$50,000/$25,000.</p>
                    <p><strong>Squatted Vehicle Law:</strong> Unlawful to drive with front fender raised 4+ inches higher than rear.</p>
                `
            },
            {
                title: "Safe Driving Practices",
                content: `
                    <p><strong>Night Driving:</strong> Use headlights, reduce speed.</p>
                    <p><strong>Adverse Weather:</strong> Slow down, increase following distance.</p>
                    <p><strong>Fatigue:</strong> Take breaks every 100 miles, get adequate sleep.</p>
                    <p><strong>Distracted Driving:</strong> No cell phone use or texting while driving.</p>
                `
            },
            {
                title: "DUI and Implied Consent",
                content: `
                    <p><strong>BAC Limits:</strong> 21+ = 0.08%; Under 21 = 0.02%.</p>
                    <p><strong>Implied Consent:</strong> Refusal to take a breath test results in 90-day license suspension.</p>
                    <p><strong>Penalties:</strong> Fines, jail time, license suspension.</p>
                `
            }
        ];

        // DOM elements
        const quizForm = document.getElementById('quiz-form');
        const submitBtn = document.getElementById('submit-btn');
        const shuffleBtn = document.getElementById('shuffle-btn');
        const resultsDiv = document.getElementById('results');
        const scoreDiv = document.getElementById('score');
        const reviewDiv = document.getElementById('review');
        const resetBtn = document.getElementById('reset-btn');
        const viewStudyGuideBtn = document.getElementById('view-study-guide-btn');
        const studyGuideDiv = document.getElementById('study-guide');
        const themeToggle = document.getElementById('theme-toggle');
        const testTab = document.getElementById('test-tab');
        const studyTab = document.getElementById('study-tab');
        const manualTab = document.getElementById('manual-tab');
        const testSection = document.getElementById('test-section');
        const manualContainer = document.getElementById('manual-container');
        const questionCountBtns = document.querySelectorAll('.question-count-btn');

        // Global variables
        let currentQuestions = [];
        let questionCount = 30; // Default question count

        // Initialize the app
        function init() {
            loadQuestions();
            setupEventListeners();
            populateStudyGuide();
        }

        // Load questions based on the selected count
        function loadQuestions() {
            // Shuffle all questions
            const shuffledQuestions = [...questions].sort(() => Math.random() - 0.5);
            
            // Select the required number of questions
            currentQuestions = shuffledQuestions.slice(0, questionCount);
            
            // Render the questions
            renderQuestions();
        }

        // Render questions to the form
        function renderQuestions() {
            quizForm.innerHTML = '';
            
            currentQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.dataset.index = index;
                
                questionDiv.innerHTML = `
                    <p><strong>Question ${index + 1}:</strong> ${q.question}</p>
                    <div class="options">
                        <label>
                            <input type="radio" name="q${index}" value="A" required>
                            A. ${q.options[0]}
                        </label>
                        <label>
                            <input type="radio" name="q${index}" value="B" required>
                            B. ${q.options[1]}
                        </label>
                        <label>
                            <input type="radio" name="q${index}" value="C" required>
                            C. ${q.options[2]}
                        </label>
                        <label>
                            <input type="radio" name="q${index}" value="D" required>
                            D. ${q.options[3]}
                        </label>
                    </div>
                `;
                
                quizForm.appendChild(questionDiv);
            });
        }

        // Shuffle the current questions
        function shuffleQuestions() {
            currentQuestions = [...currentQuestions].sort(() => Math.random() - 0.5);
            renderQuestions();
        }

        // Submit the test and show results
        function submitTest() {
            // Check if all questions are answered
            const unansweredQuestions = [];
            currentQuestions.forEach((q, index) => {
                const answered = document.querySelector(`input[name="q${index}"]:checked`);
                if (!answered) {
                    unansweredQuestions.push(index + 1);
                }
            });
            
            if (unansweredQuestions.length > 0) {
                alert(`Please answer all questions. Missing: ${unansweredQuestions.join(', ')}`);
                return;
            }
            
            // Calculate score
            let correctCount = 0;
            const reviewHtml = [];
            
            currentQuestions.forEach((q, index) => {
                const selectedAnswer = document.querySelector(`input[name="q${index}"]:checked`).value;
                const isCorrect = selectedAnswer === q.answer;
                
                if (isCorrect) {
                    correctCount++;
                }
                
                // Add to review
                reviewHtml.push(`
                    <div class="review-question ${isCorrect ? 'correct' : 'incorrect'}">
                        <p><strong>Question ${index + 1}:</strong> ${q.question}</p>
                        <p>${isCorrect ? 
                            `<span class="correct-answer">✓ Correct: ${getAnswerText(q.answer, q.options)}</span>` : 
                            `<span class="wrong-answer">✗ Your answer: ${getAnswerText(selectedAnswer, q.options)}</span><br>
                            <span class="correct-answer">Correct answer: ${getAnswerText(q.answer, q.options)}</span>`
                        }</p>
                    </div>
                `);
            });
            
            // Display results
            const passThreshold = Math.ceil(currentQuestions.length * 0.7); // 70% to pass
            const passed = correctCount >= passThreshold;
            
            scoreDiv.innerHTML = `
                <p>You scored ${correctCount} out of ${currentQuestions.length} (${Math.round(correctCount / currentQuestions.length * 100)}%)</p>
                <p>${passed ? 
                    '<span style="color:var(--correct-color)">PASSED! 🎉</span>' : 
                    '<span style="color:var(--incorrect-color)">FAILED. Need to score at least 70% to pass.</span>'
                }</p>
            `;
            
            reviewDiv.innerHTML = reviewHtml.join('');
            
            // Show results section
            resultsDiv.style.display = 'block';
            
            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // Get option text from letter (A, B, C, D)
        function getAnswerText(letter, options) {
            const index = letter.charCodeAt(0) - 65; // Convert A, B, C, D to 0, 1, 2, 3
            return `${letter}. ${options[index]}`;
        }

        // Reset the test
        function resetTest() {
            quizForm.reset();
            resultsDiv.style.display = 'none';
            loadQuestions();
            window.scrollTo(0, 0);
        }

        // Show the study guide
        function viewStudyGuide() {
            testSection.style.display = 'none';
            studyGuideDiv.style.display = 'block';
            manualContainer.style.display = 'none';
            
            // Update active tab
            testTab.classList.remove('active');
            studyTab.classList.add('active');
            manualTab.classList.remove('active');
        }

        // Populate the study guide with content
        function populateStudyGuide() {
            let html = '<h2>Mississippi Driver\'s License Study Guide (2025)</h2>';
            
            studyGuide.forEach(section => {
                html += `
                    <div class="study-section">
                        <h3>${section.title}</h3>
                        ${section.content}
                    </div>
                `;
            });
            
            studyGuideDiv.innerHTML = html;
        }

        // Change the theme
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        }

        // Show the test tab
        function showTestTab() {
            testSection.style.display = 'block';
            studyGuideDiv.style.display = 'none';
            manualContainer.style.display = 'none';
            
            // Update active tab
            testTab.classList.add('active');
            studyTab.classList.remove('active');
            manualTab.classList.remove('active');
        }

        // Show the manual tab
        function showManualTab() {
            testSection.style.display = 'none';
            studyGuideDiv.style.display = 'none';
            manualContainer.style.display = 'block';
            
            // Update active tab
            testTab.classList.remove('active');
            studyTab.classList.remove('active');
            manualTab.classList.add('active');
        }

        // Update question count
        function updateQuestionCount(count) {
            questionCount = parseInt(count);
            
            // Update active button
            questionCountBtns.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.count == count);
            });
            
            // Reload questions
            resetTest();
        }

        // Setup event listeners
        function setupEventListeners() {
            submitBtn.addEventListener('click', submitTest);
            shuffleBtn.addEventListener('click', shuffleQuestions);
            resetBtn.addEventListener('click', resetTest);
            viewStudyGuideBtn.addEventListener('click', viewStudyGuide);
            themeToggle.addEventListener('click', toggleTheme);
            testTab.addEventListener('click', showTestTab);
            studyTab.addEventListener('click', viewStudyGuide);
            manualTab.addEventListener('click', showManualTab);
            
            // Question count buttons
            questionCountBtns.forEach(btn => {
                btn.addEventListener('click', () => updateQuestionCount(btn.dataset.count));
            });
            
            // Load saved theme preference
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
            }
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
